\begin{lstlisting}[caption={LQR obtained using argumentations based on SRL.}, label={lst:lqr-srl}]
%% LQR obtained using argumentations based on Simmetric Root Locus (SRL)

sysG = ss(A, B, C, 0);
sysGp = ss(-A, -B, C, 0);

sigma = delta*w_n;

[roots,g] = rlocus(sysG*sysGp);

gain = 2.3e3;           % Value to be tuned based on root locus plot
r = 1/gain;       

poles = rlocus(sysG*sysGp,1/gain);

% Simmetric Root Locus Plot
figure;
rlocus(sysG*sysGp);
axis([-60,60,-60,60]);
hold on;
plot(-g,exp(phi)*g);
plot(-g,-g*exp(phi));
plot(real(poles), imag(poles), 'rx','Markersize', 10);
xline(sigma);
hold off;

% State Feedback Gain Computation
K = lqry(sysG,1,gain);
\end{lstlisting}
\begin{lstlisting}[caption={LQR obtained using the Brysonâ€™s rule.}, label={lst:lqr-br}]
%% LQR obtained using the Bryson's rule

sysP = ss(A, B, C, 0);

Q = diag([1/(0.3*50*pi/180)^2 , 1/(pi/36)^2, 0, 0]);
R = 1/100;

% State Feedback Gain Computation
K_br = lqr(sysP, Q ,R);
\end{lstlisting}
\begin{lstlisting}[caption={Robust tracking with LQR obtained using argumentations based on SRL.}, label={lst:lqr-srl-robust}]
%% Robust tracking with LQR obtained using argumentations based on Simmetric Root Locus (SRL)

sysG = ss(A_e, B_e, C_e, 0);
sysGp = ss(-A_e, -B_e, C_e, 0);

sigma = delta*w_n;

[roots, g] = rlocus(sysG*sysGp);

gain = 1.62e03;       % Value to be tuned based on root locus plot
r = 1/gain;

poles = rlocus(sysG*sysGp, 1/gain);

% Simmetric Root Locus Plot
figure;
rlocus(sysG*sysGp);
axis([-60,60, -60,60]);
hold on;
plot(-g, g*exp(phi));
plot(-g,-g*exp(phi));
plot(real(poles), imag(poles), 'rx','Markersize', 10);
xline(sigma);
hold off;

% Extended State Feedback Gain Computation
K_e = lqry(sysG, 1, gain);
K_I = K_e(1);
K_new = [K_e(2), K_e(3), K_e(4), K_e(5)];
\end{lstlisting}
\begin{lstlisting}[caption={Robust tracking with LQR obtained using the Bryson's rule.}, label={lst:lqr-br-robust}]
%% Robust tracking with LQR obtained using the Bryson's rule

sysP = ss(A_e, B_e, C_e, 0);

q_11 = 10^(3);
Q = diag([q_11, 1/(0.3*50*pi/180)^2 , 1/(pi/36)^2, 0, 0])
R = 1/100;

% Extended State Feedback Gain Computation
K_e_br = lqr(sysP, Q, R)
K_I = K_e_br(1);
K_new = K_e_br(2:5);
\end{lstlisting}
\begin{lstlisting}[caption={Frequency Shaped LQR for Nominal Tracking.}, label={lst:fs-resonant-freq}]
%% Frequency Shaped LQR for Nominal Tracking

sysP = ss(A, B, C, 0);

sys_poles = pole(sysP);

s = tf('s');

den = 1;
for index = 1:height(sys_poles)
    if (imag(sys_poles(index)) ~= 0)
        den = den * (s - sys_poles(index));
    end
end

den_array = cell2mat(den.Numerator);
w_0 = sqrt(den_array(1, end));

q_22 = 100;         % {0.01, 1, 100}

A_1_Q = [0, 1; -w_0^2, 0];
B_1_Q = [0; 1];
C_1_Q = [sqrt(q_22)*w_0^2, 0];
D_1_Q = 0;

A_Q = A_1_Q;
B_Q = [[0; 0], B_1_Q, [0, 0; 0, 0]];
C_Q = [[0, 0]; C_1_Q; [0, 0; 0, 0]];
D_Q = diag([1/(5*pi/180), D_1_Q, 0, 0]);

A_A = [A, [0, 0; 0, 0; 0, 0; 0, 0]; B_Q, A_Q];
B_A = [B; [0; 0;]];
C_A = [C, 0, 0];
D_A = 0;

Q_A = [D_Q.'*D_Q, D_Q.'*C_Q; C_Q.'*D_Q, C_Q.'*C_Q];
N_A = 0;
R_A = 1/(uh_bar^2);

% State Feedback Gain Computation
K_A = lqr(A_A, B_A, Q_A, 0.01, 0);

% Feedforward Gains Computation
F = [A_A, B_A; C_A, D_A];
sol = [0, 0, 0, 0, 0, 0, 1].';

N = linsolve(F, sol);
N_x = N(1:6);
N_u = N(7);
\end{lstlisting}

\begin{lstlisting}[caption={Frequency Shaped LQR with Integral Action.}, label={lst:fs-resonant-freq-robust}]
%% Frequency Shaped LQR with Integral Action

A_e = [0, C_A; zeros(6, 1), A_A];
B_e = [0; B_A];
C_e = [0, C_A];

q_I = 0.1;

Q_e = [q_I, zeros(1, 6); zeros(6, 1), Q_A];
R_e = R_A;

% Extended State Feedback Gain Computation
K_e = lqr(A_e, B_e, Q_e, R_e);
K_I = K_e(1);
K_new = K_e(2:7);
\end{lstlisting}